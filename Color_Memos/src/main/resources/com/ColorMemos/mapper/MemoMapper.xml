<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ColorMemos.mapper.MemoMapper">

	<!-- 메모 생성 -->
	<insert id="memoRegister">
		INSERT INTO MEMO 
			(MNO
			,MNAME
			,MDESCRIPTION
			,REGDAY
			,REGID
			,MCOLOR
			)
		VALUES(	MEMO_SEQ.NEXTVAL
				,#{mname}
				,#{mdescription}
				,SYSDATE
				,#{regid} 
				,#{mcolor}
				)
	</insert>
	
	<!-- 메모 리스트 -->
	<select id="memoList" resultType="com.ColorMemos.domain.MemoDTO">
		SELECT
			MNO 	
			,MNAME
			,MDESCRIPTION
			,TO_CHAR(REGDAY,'YY/MM/DD')REGDAY
			,REGID
			,MCOLOR
			,HIDE_GB
            ,FAVORITE_GB
            ,DELETE_GB
            ,DELT_DATE
            ,RESTORE_DATE
		FROM MEMO
		WHERE REGID = #{email} AND DELETE_GB = 0
		ORDER BY FAVORITE_GB DESC, MNO DESC
	</select>
	
	<!-- 메모 숨김제외 리스트 -->
	<select id="memoList_h" resultType="com.ColorMemos.domain.MemoDTO">
		SELECT
			MNO 	
			,MNAME
			,MDESCRIPTION
			,TO_CHAR(REGDAY,'YY/MM/DD')REGDAY
			,REGID
			,MCOLOR
			,HIDE_GB
            ,FAVORITE_GB
            ,DELETE_GB
            ,DELT_DATE
            ,RESTORE_DATE
		FROM MEMO
		WHERE REGID = #{email} AND DELETE_GB = 0 AND HIDE_GB = 0
		ORDER BY FAVORITE_GB DESC, MNO DESC
	</select>
	
	<!-- 삭제된 메모 리스트 -->
	<select id="delt_memoList" resultType="com.ColorMemos.domain.MemoDTO">
		SELECT
			MNO 	
			,MNAME
			,MDESCRIPTION
			,TO_CHAR(REGDAY,'YY/MM/DD')REGDAY
			,REGID
			,MCOLOR
			,HIDE_GB
            ,FAVORITE_GB
            ,DELETE_GB
            ,DELT_DATE
            ,RESTORE_DATE
		FROM MEMO
		WHERE REGID = #{email} AND DELETE_GB = 1
		ORDER BY MNO DESC
	</select>
	
	<!-- 메모 삭제 -->
	<update id="memoDelete">
		UPDATE MEMO SET DELETE_GB = 1, DELT_DATE = SYSDATE
		WHERE MNO = #{mno}
	</update>
	
	<!-- 메모 복구 -->
	<update id="memoRestore">
		UPDATE MEMO SET DELETE_GB = 0, RESTORE_DATE = SYSDATE
		WHERE MNO = #{mno}
	</update>
	
	<!-- 메모 숨김 구분값 -->
	<select id="selectHideGB" resultType="Integer">
		SELECT HIDE_GB
		FROM MEMO
		WHERE MNO = #{mno}
	</select>
	
	<!-- 메모 숨김 -->
	<update id="memoHide">
		UPDATE MEMO SET HIDE_GB = 1
		WHERE MNO = #{mno}
	</update>
	
	<!-- 메모 숨김 취소 -->
	<update id="memoHideCancel">
		UPDATE MEMO SET HIDE_GB = 0
		WHERE MNO = #{mno}
	</update>
	
	<!-- 메모 즐겨찾기 구분값 -->
	<select id="selectFavGB" resultType="Integer">
		SELECT FAVORITE_GB 
		FROM MEMO
		WHERE MNO = #{mno}
	</select>
	
	<!-- 메모 즐겨찾기 -->
	<update id="memoFav">
		UPDATE MEMO SET FAVORITE_GB = 1
		WHERE MNO = #{mno}
	</update>
	
	<!-- 메모 즐겨찾기 취소 -->
	<update id="memoFavCancel">
		UPDATE MEMO SET FAVORITE_GB = 0
		WHERE MNO = #{mno}
	</update>
	
	<!-- 메모 수정 -->
	<select id="modifyMemo_mno" resultType="com.ColorMemos.domain.MemoDTO">
		SELECT * FROM MEMO WHERE MNO = #{mno} 
	</select>
	
	<!-- 메모 수정 -->
	<update id="modifyMemo">
		UPDATE MEMO SET MNAME = #{mname}, MDESCRIPTION = #{mdescription} 
		WHERE MNO = #{mno}
	</update>
	
</mapper>